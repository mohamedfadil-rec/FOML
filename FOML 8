# Import required libraries
import pandas as pd
import numpy as np
from sklearn.ensemble import AdaBoostClassifier
from sklearn.tree import DecisionTreeClassifier
from mlxtend.plotting import plot_decision_regions
import matplotlib.pyplot as plt

# Step 1: Create dataset
df = pd.DataFrame()
df['X1'] = [1,2,3,4,5,6,6,7,9,9]
df['X2'] = [5,3,6,8,1,9,5,8,9,2]
df['label'] = [1,1,0,1,0,1,0,1,0,0]

# Step 2: Prepare features and labels
X = df[['X1', 'X2']].values
y = df['label'].values

# Step 3: Initialize base (weak) learner
base_clf = DecisionTreeClassifier(max_depth=1)

# Step 4: Create AdaBoost classifier
ada = AdaBoostClassifier(estimator=base_clf, n_estimators=10, learning_rate=1.0, random_state=1)

# Step 5: Train AdaBoost
ada.fit(X, y)

# Step 6: Plot decision regions
plt.figure(figsize=(8,6))
plot_decision_regions(X, y, clf=ada, legend=2)
plt.title('AdaBoost Decision Boundary')
plt.xlabel('X1')
plt.ylabel('X2')
plt.show()

#Gradient Boosting
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
from sklearn.ensemble import GradientBoostingRegressor

# Step 1: Generate dataset
np.random.seed(42)
X = np.random.rand(100, 1) - 0.5   # Random X values in [-0.5, 0.5]
y = 3 * X[:, 0]**2 + 0.05 * np.random.randn(100)  # Parabolic relation with noise

# Convert to DataFrame (optional, for easy viewing)
df = pd.DataFrame({'X': X[:, 0], 'y': y})

# Step 2: Create Gradient Boosting Regressor
model = GradientBoostingRegressor(
    n_estimators=200,   # number of boosting stages
    learning_rate=0.1,  # step size shrinkage
    max_depth=3,        # tree depth (controls model complexity)
    random_state=42
)

# Step 3: Train model
model.fit(X, y)

# Step 4: Predict on a smooth range of X for curve plotting
X_test = np.linspace(-0.5, 0.5, 200).reshape(-1, 1)
y_pred = model.predict(X_test)

# Step 5: Plot results
plt.figure(figsize=(8,6))
plt.scatter(X, y, color='blue', label='Training Data')
plt.plot(X_test, y_pred, color='red', linewidth=2, label='Gradient Boosting Fit')
plt.title("Gradient Boosting Regression Example")
plt.xlabel("X")
plt.ylabel("y")
plt.legend()
plt.show()
